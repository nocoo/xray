#!/usr/bin/env sh
. "$(dirname -- "$0")/_/h"

# Root-level unit tests (scripts, agent)
bun test tests/ --timeout 30000

# Server: all tests including E2E
cd server && bun test

# Next.js unit tests
cd .. && bun test src/__tests__/auth.test.ts src/__tests__/crypto.test.ts src/__tests__/db/ src/__tests__/api/

# Lint
bun run lint

# Next.js E2E tests
bun test src/__tests__/e2e/
